estimate then allocate, instead of using dynamic DSs.
